function Gallery(){this.items=document.querySelectorAll("article.gallery-item"),this.bg=document.querySelector(".backimage"),this.init=function(){for(var e=this,t=0;t<e.items.length;t++)e.items[t].addEventListener("click",function(){e.changeImage(this)});e.swipeDetection(function(t){if("none"===t)return!1;var n,i=document.querySelector(".gallery-item.active");"left"!==t&&"top"!==t||null===(n=i.previousElementSibling)&&(n=e.items[e.items.length-1]),"right"!==t&&"bottom"!==t||null===(n=i.nextElementSibling)&&(n=e.items[0]),n.onclick?n.onclick():n.click&&n.click()}),this.changeImage(this.items[0])},this.changeImage=function(e){for(var t=this,n=e.querySelector("img").src,i=0;i<t.items.length;i++)t.items[i].classList.remove("active");e.classList.add("active"),t.bg.classList.remove("fadeout","fadein"),t.bg.classList.add("fadeout"),setTimeout(function(){t.bg.classList.remove("fadeout"),t.bg.classList.add("fadein"),t.bg.style.backgroundImage="url('"+n+"')"},500)},this.swipeDetection=function(e){var t,n,i,a,o,l,r=this.bg,s=e||function(e){};r.addEventListener("touchstart",function(e){var a=e.changedTouches[0];t="none",dist=0,n=a.pageX,i=a.pageY,l=(new Date).getTime(),e.preventDefault()},!1),r.addEventListener("touchmove",function(e){e.preventDefault()},!1),r.addEventListener("touchend",function(e){var r=e.changedTouches[0];a=r.pageX-n,o=r.pageY-i,(new Date).getTime()-l<=300&&(Math.abs(a)>=80&&Math.abs(o)<=100?t=a<0?"left":"right":Math.abs(o)>=80&&Math.abs(a)<=100&&(t=o<0?"up":"down")),s(t),e.preventDefault()},!1)},this.init()}!function(t){var n={el:null,init:function(){for(var t=this,n=document.querySelectorAll("body .accordion"),i=0;i<n.length;i++)n[i].addEventListener("click",function(n){var i=n.target||e.srcElement;i.className.indexOf("menu-label")>-1&&t._toggleActive(i)})},_toggleActive:function(e){var t=e.nextElementSibling;return-1===e.className.indexOf("active")?(e.classList.add("active"),t.style.height=1.3*this._innerHeight(t)+"px"):(e.classList.remove("active"),t.style.height=0),e},_innerHeight:function(e){height=0;for(var t=e.querySelectorAll("*"),n=0;n<t.length;n++)height+=t[n].clientHeight;return height}};window.$AC=n}(),$AC.init(),function(window){var calc={result:null,elements:{display:document.getElementById("display")},_setDisplay:function(e){display.value=e},clear:function(){this._setDisplay("")},del:function(){var e=this.elements.display.value.slice(0,-1);"."!==e[e.length-1]&&","!==e[e.length-1]||(e=e.slice(0,-1)),this._setDisplay(e)},equals:function(){this.result=this.elements.display.value;var evalCode=this.result/100+";";this._setDisplay(eval(evalCode))}};window.calc=calc}(window),function(e){function t(e){var t=e;this.items=t.querySelectorAll(".carousel__items > .carousel__item"),this.navItems=null,this.arrows=null,this.init=function(){this._generateNavigation(),this._generateArrows()},this.goTo=function(e){var n=t.querySelector(".carousel__nav > .carousel__nav-item--active"),i=t.querySelector(".carousel__item--active");n.classList.remove("carousel__nav-item--active"),i.classList.remove("carousel__item--active"),this.navItems[e].classList.add("carousel__nav-item--active"),this.items[e].classList.add("carousel__item--active")},this.arrowNav=function(e){var n=t.querySelector(".carousel__nav > .carousel__nav-item--active"),i=Number.parseInt(n.dataset.index)+e;void 0===this.navItems[i]&&(i=e>0?0:this.navItems.length-1),this.goTo(i)},this._generateNavigation=function(){var e=this,n=this.items,i="",a="carousel__nav-item--active",o=document.createElement("div");i+='<ul class="carousel__nav">';for(var l=0;l<n.length;l++)i+='<li class="carousel__nav-item '+a+'" data-index='+l+"> </li>",a="";i+="</ul>",o.innerHTML=i,t.appendChild(o),this.navItems=t.querySelectorAll(".carousel__nav > li");for(l=0;l<this.navItems.length;l++)this.navItems[l].addEventListener("click",function(){e.arrowNav(1),e.goTo(this.dataset.index)})},this._generateArrows=function(){var e=this,n=document.createElement("div");n.innerHTML='<span class="carousel__arrow carousel__arrow--left fa fa-chevron-left"></span><span class="carousel__arrow carousel__arrow--right fa fa-chevron-right"></span>',t.appendChild(n),t.querySelector(".carousel__arrow--left").addEventListener("click",function(){e.arrowNav(-1)}),t.querySelector(".carousel__arrow--right").addEventListener("click",function(){e.arrowNav(1)})}}window.carousel=function(e){for(var n=document.querySelectorAll(".carousel"),i=0;i<n.length;i++){var a=new t(n[i]);a.init()}return a}()}();var $G=new Gallery;function windowWidthCount(){document.querySelector(".window-width-label").innerHTML=window.outerWidth}function closeLateralMenu(){document.querySelector("#menu-open").checked=""}function loadLiveExample(e){document.querySelector(".iframe-live").src=e}window.onload=function(){windowWidthCount()},window.addEventListener("resize",function(){windowWidthCount()}),function(e){$images=document.querySelectorAll("img[data-src]");for(var t=0;t<$images.length;t++){var n=a();$images[t].parentElement.insertBefore(n,$images[t]),$images[t].setAttribute("src",$images[t].getAttribute("data-src")),$images[t].onload=i($images[t],n)}function i(e,t){return function(){t.remove(),e.removeAttribute("data-src")}}function a(){var e=document.createElement("div");return e.classList.add("img-loader"),e.innerHTML='<div class="img-loader__icon"><span class="fa fa-refresh fa-spin"></span></div>',e}}(window),function(e){var t="modal__overlay--active";function n(e){e.style.opacity=1,function n(){(e.style.opacity-=.1)<0?(e.style.display="none",e.classList.remove(t)):requestAnimationFrame(n)}()}e.modal=function(e){var i,a=null,o=document.querySelector('[data-modal-id="'+e+'"]');return document.querySelector('.modal__overlay > [data-modal-id="'+e+'"]')&&(a=document.querySelector('.modal__overlay > [data-modal-id="'+e+'"]').parentElement),null===a&&(i=document.querySelector("body"),(a=document.createElement("section")).style.display="none",a.classList.add("modal__overlay"),a.classList.add("modal__overlay--active"),o.style.display="block",a.appendChild(o),i.appendChild(a),function(){for(var e=a.querySelectorAll("[data-close]"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){n(a)})}()),{fadeIn:function(){var e;console.log(a),(e=a).style.opacity=0,e.style.display="block",function n(){var i=parseFloat(e.style.opacity);(i+=.1)>1||(e.style.opacity=i,e.classList.add(t),requestAnimationFrame(n))}()},fadeOut:function(){console.log(a),n(a)}}};for(var i=document.querySelectorAll("[data-modal-open]"),a=0;a<i.length;a++)i[a].addEventListener("click",function(){var t=this.dataset.modalOpen;e.modal(t).fadeIn()})}(window),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},function(e){var t=this,n=document.querySelector(".content-holder"),i=document.querySelector(".navbar").getBoundingClientRect().height+10;t.getPosY=function(e){return(e=e.getBoundingClientRect()).top+n.scrollTop-i},t.scrollToElement=function(i,a,o){if(a||(a=1e3),i.nodeName||(i=document.querySelector(i)),!i)throw"Element inexistent!";var l,r=n.scrollTop,s=t.getPosY(i)-r;e.requestAnimFrame(function t(i){l||(l=i);var c,u=i-l,d=Math.min(u/a,1);d=(c=d)<.5?4*c*c*c:(c-1)*(2*c-2)*(2*c-2)+1,n.scrollTo(0,r+s*d),u<a?e.requestAnimFrame(t):o&&o()})},e.scrollToElement=t.scrollToElement}(window),function(e){var t=document.querySelectorAll(".tab__title");function n(e){for(var t=document.querySelectorAll(".tab__title--selected"),n=document.querySelector(".tab__content--selected"),i=document.querySelector("[data-content-id='"+e+"']"),a=document.querySelectorAll("[data-tab-id='"+e+"']"),o=0;o<t.length;o++)t[o].classList.remove("tab__title--selected");for(o=0;o<a.length;o++)a[o].classList.add("tab__title--selected");n.classList.remove("tab__content--selected"),i.classList.add("tab__content--selected")}for(var i=0;i<t.length;i++)t[i].addEventListener("click",function(){n(this.dataset.tabId)});var a=document.querySelectorAll(".tab__container > .tab__title");for(i=0;i<a.length;i++)a[i].addEventListener("click",function(){e.scrollToElement(this,1e3)})}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdhbGxlcnkuanMiLCJhY2NvcmRpb24uanMiLCJjYWxjdWxhdG9yLmpzIiwiY2Fyb3VzZWwuanMiLCJnbG9iYWwuanMiLCJsYXp5LWxvYWQuanMiLCJtb2RhbC5qcyIsInNjcm9sbHRvLmpzIiwidGFiLmpzIl0sIm5hbWVzIjpbIkdhbGxlcnkiLCJ0aGlzIiwiaXRlbXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJiZyIsInF1ZXJ5U2VsZWN0b3IiLCJpbml0Iiwic2VsZiIsIngiLCJsZW5ndGgiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hhbmdlSW1hZ2UiLCJzd2lwZURldGVjdGlvbiIsInN3aXBlRGlyIiwic2VsZWN0ZWRJdGVtIiwiYWN0aXZlSXRlbSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJuZXh0RWxlbWVudFNpYmxpbmciLCJvbmNsaWNrIiwiY2xpY2siLCJpdGVtIiwic3JjIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwic2V0VGltZW91dCIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiY2FsbGJhY2siLCJzd2lwZWRpciIsInN0YXJ0WCIsInN0YXJ0WSIsImRpc3RYIiwiZGlzdFkiLCJzdGFydFRpbWUiLCJ0b3VjaHN1cmZhY2UiLCJoYW5kbGVzd2lwZSIsImUiLCJ0b3VjaG9iaiIsImNoYW5nZWRUb3VjaGVzIiwiZGlzdCIsInBhZ2VYIiwicGFnZVkiLCJEYXRlIiwiZ2V0VGltZSIsInByZXZlbnREZWZhdWx0IiwiTWF0aCIsImFicyIsIndpbmRvdyIsImFjY29yZGlvbiIsImVsIiwiYWNMaXN0IiwiZXZlbnQiLCJjbGlja2VkRWxlbWVudCIsInRhcmdldCIsInNyY0VsZW1lbnQiLCJjbGFzc05hbWUiLCJpbmRleE9mIiwiX3RvZ2dsZUFjdGl2ZSIsImJvZHlFbCIsImhlaWdodCIsIl9pbm5lckhlaWdodCIsImlubmVyRWxlbWVudHMiLCJpIiwiY2xpZW50SGVpZ2h0IiwiJEFDIiwiY2FsYyIsInJlc3VsdCIsImVsZW1lbnRzIiwiZGlzcGxheSIsImdldEVsZW1lbnRCeUlkIiwiX3NldERpc3BsYXkiLCJjb250ZW50IiwidmFsdWUiLCJjbGVhciIsImRlbCIsImRpc3BsYXlWYWx1ZSIsInNsaWNlIiwiZXF1YWxzIiwiZXZhbENvZGUiLCJldmFsIiwiQ2Fyb3VzZWwiLCJlbGVtZW50Iiwicm9vdCIsIm5hdkl0ZW1zIiwiYXJyb3dzIiwiX2dlbmVyYXRlTmF2aWdhdGlvbiIsIl9nZW5lcmF0ZUFycm93cyIsImdvVG8iLCJpbmRleCIsInNlbGVjdGVkTmF2Iiwic2VsZWN0ZWRDb250ZW50IiwiYXJyb3dOYXYiLCJkaXJlY3Rpb24iLCJnb3RvSW5kZXgiLCJOdW1iZXIiLCJwYXJzZUludCIsImRhdGFzZXQiLCJ1bmRlZmluZWQiLCJodG1sIiwiZmlyc3RDbGFzcyIsIm5hdkVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJhcnJvd0NvbnRhaW5lciIsImNhcm91c2VsIiwiY2Fyb3VzZWxzIiwiY2FyIiwiJEciLCJ3aW5kb3dXaWR0aENvdW50Iiwib3V0ZXJXaWR0aCIsImNsb3NlTGF0ZXJhbE1lbnUiLCJjaGVja2VkIiwibG9hZExpdmVFeGFtcGxlIiwib25sb2FkIiwiJGltYWdlcyIsImxvYWRpbmciLCJjcmVhdGVMb2FkaW5nIiwicGFyZW50RWxlbWVudCIsImluc2VydEJlZm9yZSIsInNldEF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsIm9uTG9hZEltYWdlIiwiaW1hZ2UiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjYkNsYXNzIiwiZmFkZU91dCIsIm9wYWNpdHkiLCJmYWRlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibW9kYWwiLCJpZE1vZGFsIiwiYm9keSIsIm1vZGFsT3ZlcmxheSIsImNsb3NlRWxlbWVudHMiLCJfcmVnaXN0ZXJDbG9zZUV2ZW50cyIsImZhZGVJbiIsImNvbnNvbGUiLCJsb2ciLCJ2YWwiLCJwYXJzZUZsb2F0IiwibW9kYWxPcGVuZXJzIiwibW9kYWxPcGVuIiwicmVxdWVzdEFuaW1GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsInNjcm9sbFdpbmRvdyIsIm1lbnVIZWlnaHQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJnZXRQb3NZIiwidG9wIiwic2Nyb2xsVG9wIiwic2Nyb2xsVG9FbGVtZW50IiwiZHVyYXRpb24iLCJjYkZ1bmN0aW9uIiwibm9kZU5hbWUiLCJzdGFydCIsInN0YXJ0aW5nWSIsImRpZmYiLCJzdGVwIiwidGltZXN0YW1wIiwidCIsInRpbWUiLCJwZXJjZW50IiwibWluIiwic2Nyb2xsVG8iLCJ0YWJzIiwidG9nZ2xlVGFiIiwidGFiSWQiLCJwcmV2aW91c1RhYnMiLCJwcmV2aW91c0NvbnRlbnQiLCJhY3RpdmVDb250ZW50IiwiYWN0aXZlVGFicyIsInRhYnNDb250YWluZXIiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLFVBQ0FDLEtBQUFDLE1BQUFDLFNBQUFDLGlCQUFBLHdCQUNBSCxLQUFBSSxHQUFBRixTQUFBRyxjQUFBLGNBRUFMLEtBQUFNLEtBQUEsV0FFQSxJQURBLElBQUFDLEVBQUFQLEtBQ0FRLEVBQUEsRUFBQUEsRUFBQUQsRUFBQU4sTUFBQVEsT0FBQUQsSUFDQUQsRUFBQU4sTUFBQU8sR0FBQUUsaUJBQUEsUUFBQSxXQUNBSCxFQUFBSSxZQUFBWCxRQUtBTyxFQUFBSyxlQUFBLFNBQUFDLEdBRUEsR0FBQSxTQUFBQSxFQUFBLE9BQUEsRUFFQSxJQUVBQyxFQUZBQyxFQUFBYixTQUFBRyxjQUFBLHdCQUdBLFNBQUFRLEdBQUEsUUFBQUEsR0FJQSxRQUZBQyxFQUFBQyxFQUFBQywwQkFJQUYsRUFBQVAsRUFBQU4sTUFBQU0sRUFBQU4sTUFBQVEsT0FBQSxJQUlBLFVBQUFJLEdBQUEsV0FBQUEsR0FJQSxRQUZBQyxFQUFBQyxFQUFBRSxzQkFJQUgsRUFBQVAsRUFBQU4sTUFBQSxJQUtBYSxFQUFBSSxRQUNBSixFQUFBSSxVQUNBSixFQUFBSyxPQUNB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QUEzSyxTQUFBQyxpQkFBQSxpQkFBQXNLLEVBQUEsTUFHQTFHLEVBQUEsRUFBQUEsRUFBQTJHLEVBQUFqSyxPQUFBc0QsSUFDQTJHLEVBQUEzRyxHQUFBekMsVUFBQUMsT0FBQSx3QkFJQSxJQUFBd0MsRUFBQSxFQUFBQSxFQUFBOEcsRUFBQXBLLE9BQUFzRCxJQUNBOEcsRUFBQTlHLEdBQUF6QyxVQUFBRSxJQUFBLHdCQUlBbUosRUFBQXJKLFVBQUFDLE9BQUEsMEJBQ0FxSixFQUFBdEosVUFBQUUsSUFBQSwwQkFHQSxJQUFBLElBQUF1QyxFQUFBLEVBQUFBLEVBQUF3RyxFQUFBOUosT0FBQXNELElBRUF3RyxFQUFBeEcsR0FBQXJELGlCQUFBLFFBQUEsV0FDQThKLEVBQUF4SyxLQUFBaUcsUUFBQXdFLFNBSUEsSUFBQUssRUFBQTVLLFNBQUFDLGlCQUFBLGlDQUVBLElBQUE0RCxFQUFBLEVBQUFBLEVBQUErRyxFQUFBckssT0FBQXNELElBRUErRyxFQUFBL0csR0FBQXJELGlCQUFBLFFBQUEsV0FDQXNDLEVBQUF5RyxnQkFBQXpKLEtBQUEsT0FyQ0EsQ0F5Q0FnRCIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gR2FsbGVyeSgpIHtcclxuXHR0aGlzLml0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYXJ0aWNsZS5nYWxsZXJ5LWl0ZW0nKTtcclxuXHR0aGlzLmJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJhY2tpbWFnZScpO1xyXG5cclxuXHR0aGlzLmluaXQgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBzZWxmID0gdGhpcztcdFx0XHJcblx0XHRmb3IodmFyIHggPSAwOyB4IDwgc2VsZi5pdGVtcy5sZW5ndGg7IHgrKykge1xyXG5cdFx0XHRzZWxmLml0ZW1zW3hdLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHNlbGYuY2hhbmdlSW1hZ2UodGhpcyk7XHJcblx0XHRcdH0pO1x0XHRcdFxyXG5cdFx0fVxyXG5cclxuXHRcdC8vSW5pdCBzd2lwZSBkZXRlY3Rpb25cclxuXHRcdHNlbGYuc3dpcGVEZXRlY3Rpb24oZnVuY3Rpb24oc3dpcGVEaXIpe1xyXG5cclxuXHRcdFx0aWYoc3dpcGVEaXIgPT09ICdub25lJykgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdFx0dmFyIGFjdGl2ZUl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeS1pdGVtLmFjdGl2ZScpO1xyXG5cclxuXHRcdFx0dmFyIHNlbGVjdGVkSXRlbTtcclxuXHRcdFx0aWYoc3dpcGVEaXIgPT09IFwibGVmdFwiIHx8IHN3aXBlRGlyID09PSBcInRvcFwiKSB7XHJcblx0XHRcdFx0Ly9QcmV2aW91c1xyXG5cdFx0XHRcdHNlbGVjdGVkSXRlbSA9IGFjdGl2ZUl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZztcclxuXHJcblx0XHRcdFx0aWYoc2VsZWN0ZWRJdGVtID09PSBudWxsKSB7XHJcblx0XHRcdFx0XHQvL0lmIHRoZXJlIGlzIG5vIHByZXZpb3VzIGl0ZW0sIHVzZXMgdGhlIGxhc3Qgb25lXHJcblx0XHRcdFx0XHRzZWxlY3RlZEl0ZW0gPSBzZWxmLml0ZW1zW3NlbGYuaXRlbXMubGVuZ3RoIC0xXTtcclxuXHRcdFx0XHR9XHRcdFx0XHRcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYoc3dpcGVEaXIgPT09IFwicmlnaHRcIiB8fCBzd2lwZURpciA9PT0gXCJib3R0b21cIikge1xyXG5cdFx0XHRcdC8vTmV4dFxyXG5cdFx0XHRcdHNlbGVjdGVkSXRlbSA9IGFjdGl2ZUl0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nO1x0XHJcblxyXG5cdFx0XHRcdGlmKHNlbGVjdGVkSXRlbSA9PT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0Ly9JZiB0aGVyZSBpcyBubyBuZXh0IGl0ZW0sIHVzZXMgdGhlIGZpcnN0IG9uZVxyXG5cdFx0XHRcdFx0c2VsZWN0ZWRJdGVtID0gc2VsZi5pdGVtc1swXTtcclxuXHRcdFx0XHR9XHRcdFx0XHRcdFxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvL0ZGL0Nocm9tZSBjbGljayBuYW1lIGZ1bmN0aW9uIGRpZmZlcmVuY2VcclxuXHRcdFx0aWYgKHNlbGVjdGVkSXRlbS5vbmNsaWNrKSB7XHJcblx0XHRcdCAgIHNlbGVjdGVkSXRlbS5vbmNsaWNrKCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoc2VsZWN0ZWRJdGVtLmNsaWNrKSB7XHJcblx0XHRcdCAgIHNlbGVjdGVkSXRlbS5jbGljaygpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLmNoYW5nZUltYWdlKHRoaXMuaXRlbXNbMF0pO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuY2hhbmdlSW1hZ2UgPSBmdW5jdGlvbihpdGVtKSB7XHJcblx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHR2YXIgc3JjID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdpbWcnKS5zcmM7XHJcblxyXG5cdFx0Zm9yKHZhciB4ID0gMDsgeCA8IHNlbGYuaXRlbXMubGVuZ3RoOyB4KyspIHtcclxuXHRcdFx0c2VsZi5pdGVtc1t4XS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuXHRcdH1cclxuXHJcblx0XHQvL3NldCB0aGUgc2VsZWN0ZWQgaXRlbSBhcyBhY3RpdmVcclxuXHRcdGl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcblxyXG5cclxuXHRcdHNlbGYuYmcuY2xhc3NMaXN0LnJlbW92ZSgnZmFkZW91dCcsJ2ZhZGVpbicpO1xyXG5cdFx0c2VsZi5iZy5jbGFzc0xpc3QuYWRkKCdmYWRlb3V0Jyk7XHJcblxyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xyXG5cdFx0XHRzZWxmLmJnLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGVvdXQnKTtcclxuXHRcdFx0c2VsZi5iZy5jbGFzc0xpc3QuYWRkKCdmYWRlaW4nKTtcclxuXHRcdFx0c2VsZi5iZy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnXCIrc3JjK1wiJylcIjtcclxuXHRcdH0sNTAwKTtcclxuXHRcdFxyXG5cclxuXHR9O1xyXG5cdFxyXG5cdC8vIFRoYW5rcyB0byBodHRwOi8vd3d3LmphdmFzY3JpcHRraXQuY29tL2phdmF0dXRvcnMvdG91Y2hldmVudHMyLnNodG1sXHJcblx0Ly8gUFM6LiBJJ3ZlIGRvbmUgdGhpcyBqdXN0IGZvciBzdHVkeSBwdXJwb3NlcywgaSdkIHJhdGhlciB0byBzZXBhcmF0ZSB0aGlzIGNvZGUgb3V0c2lkZSB0aGUgZ2FsbGVyeSBpdHNlbGZcclxuXHR0aGlzLnN3aXBlRGV0ZWN0aW9uID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuXHRcdHZhciB0b3VjaHN1cmZhY2UgPSB0aGlzLmJnLFxyXG5cdFx0c3dpcGVkaXIsXHJcblx0ICAgIHN0YXJ0WCxcclxuXHQgICAgc3RhcnRZLFxyXG5cdCAgICBkaXN0WCxcclxuXHQgICAgZGlzdFksXHJcblx0ICAgIHRocmVzaG9sZCA9IDgwLCAvL3JlcXVpcmVkIG1pbiBkaXN0YW5jZSB0cmF2ZWxlZCB0byBiZSBjb25zaWRlcmVkIHN3aXBlXHJcblx0ICAgIHJlc3RyYWludCA9IDEwMCwgLy8gbWF4aW11bSBkaXN0YW5jZSBhbGxvd2VkIGF0IHRoZSBzYW1lIHRpbWUgaW4gcGVycGVuZGljdWxhciBkaXJlY3Rpb25cclxuXHQgICAgYWxsb3dlZFRpbWUgPSAzMDAsIC8vIG1heGltdW0gdGltZSBhbGxvd2VkIHRvIHRyYXZlbCB0aGF0IGRpc3RhbmNlXHJcblx0ICAgIGVsYXBzZWRUaW1lLFxyXG5cdCAgICBzdGFydFRpbWUsXHJcblx0ICAgIGhhbmRsZXN3aXBlID0gY2FsbGJhY2sgfHwgZnVuY3Rpb24oc3dpcGVkaXIpe31cclxuXHJcblx0ICAgIHRvdWNoc3VyZmFjZS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oZSl7XHJcblx0ICAgICAgICB2YXIgdG91Y2hvYmogPSBlLmNoYW5nZWRUb3VjaGVzWzBdXHJcblx0ICAgICAgICBzd2lwZWRpciA9ICdub25lJ1xyXG5cdCAgICAgICAgZGlzdCA9IDBcclxuXHQgICAgICAgIHN0YXJ0WCA9IHRvdWNob2JqLnBhZ2VYXHJcblx0ICAgICAgICBzdGFydFkgPSB0b3VjaG9iai5wYWdlWVxyXG5cdCAgICAgICAgc3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLy8gcmVjb3JkIHRpbWUgd2hlbiBmaW5nZXIgZmlyc3QgbWFrZXMgY29udGFjdCB3aXRoIHN1cmZhY2VcclxuXHQgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG5cdCAgICB9LCBmYWxzZSk7XHJcblxyXG5cdCAgICB0b3VjaHN1cmZhY2UuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24oZSl7XHJcblx0ICAgICAgICBlLnByZXZlbnREZWZhdWx0KCkgLy8gcHJldmVudCBzY3JvbGxpbmcgd2hlbiBpbnNpZGUgRElWXHJcblx0ICAgIH0sIGZhbHNlKTtcdFxyXG5cdFx0ICAgIFxyXG5cdCAgICB0b3VjaHN1cmZhY2UuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbihlKXtcclxuXHQgICAgICAgIHZhciB0b3VjaG9iaiA9IGUuY2hhbmdlZFRvdWNoZXNbMF1cclxuXHQgICAgICAgIGRpc3RYID0gdG91Y2hvYmoucGFnZVggLSBzdGFydFggLy8gZ2V0IGhvcml6b250YWwgZGlzdCB0cmF2ZWxlZCBieSBmaW5nZXIgd2hpbGUgaW4gY29udGFjdCB3aXRoIHN1cmZhY2VcclxuXHQgICAgICAgIGRpc3RZID0gdG91Y2hvYmoucGFnZVkgLSBzdGFydFkgLy8gZ2V0IHZlcnRpY2FsIGRpc3QgdHJhdmVsZWQgYnkgZmluZ2VyIHdoaWxlIGluIGNvbnRhY3Qgd2l0aCBzdXJmYWNlXHJcblx0ICAgICAgICBlbGFwc2VkVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gc3RhcnRUaW1lIC8vIGdldCB0aW1lIGVsYXBzZWRcclxuXHQgICAgICAgIGlmIChlbGFwc2VkVGltZSA8PSBhbGxvd2VkVGltZSl7IC8vIGZpcnN0IGNvbmRpdGlvbiBmb3IgYXdpcGUgbWV0XHJcblx0ICAgICAgICAgICAgaWYgKE1hdGguYWJzKGRpc3RYKSA+PSB0aHJlc2hvbGQgJiYgTWF0aC5hYnMoZGlzdFkpIDw9IHJlc3RyYWludCl7IC8vIDJuZCBjb25kaXRpb24gZm9yIGhvcml6b250YWwgc3dpcGUgbWV0XHJcblx0ICAgICAgICAgICAgICAgIHN3aXBlZGlyID0gKGRpc3RYIDwgMCk/ICdsZWZ0JyA6ICdyaWdodCcgLy8gaWYgZGlzdCB0cmF2ZWxlZCBpcyBuZWdhdGl2ZSwgaXQgaW5kaWNhdGVzIGxlZnQgc3dpcGVcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZSBpZiAoTWF0aC5hYnMoZGlzdFkpID49IHRocmVzaG9sZCAmJiBNYXRoLmFicyhkaXN0WCkgPD0gcmVzdHJhaW50KXsgLy8gMm5kIGNvbmRpdGlvbiBmb3IgdmVydGljYWwgc3dpcGUgbWV0XHJcblx0ICAgICAgICAgICAgICAgIHN3aXBlZGlyID0gKGRpc3RZIDwgMCk/ICd1cCcgOiAnZG93bicgLy8gaWYgZGlzdCB0cmF2ZWxlZCBpcyBuZWdhdGl2ZSwgaXQgaW5kaWNhdGVzIHVwIHN3aXBlXHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgaGFuZGxlc3dpcGUoc3dpcGVkaXIpXHJcblx0ICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcclxuXHQgICAgfSwgZmFsc2UpOyAgICAgICAgXHJcblxyXG5cdH1cclxuXHJcblx0dGhpcy5pbml0KCk7XHJcbn1cclxuXHJcbnZhciAkRyA9IG5ldyBHYWxsZXJ5KCk7IiwiKGZ1bmN0aW9uKHdpbmRvdyl7XHJcblx0XHR2YXIgYWNjb3JkaW9uID0ge307XHJcblxyXG5cdFx0YWNjb3JkaW9uLmVsID0gbnVsbDtcclxuXHJcblx0XHRhY2NvcmRpb24uaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG5cdFx0XHQvL0xpc3QgYWxsIGFjY29yZGlvbnNcclxuXHRcdFx0dmFyIGFjTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JvZHkgLmFjY29yZGlvbicpO1xyXG5cclxuXHRcdFx0Ly9UbyBlYWNoIG9uZVxyXG5cdFx0XHRmb3IoIHZhciB4PTA7IHg8IGFjTGlzdC5sZW5ndGg7IHgrKykge1xyXG5cdFx0XHRcdC8vQWRkIG1lbnUtbGFiZWwgY2xpY2sgZXZlbnQgdG8gc2hvdy9oaWRlIGJvZGR5XHJcblx0XHRcdFx0YWNMaXN0W3hdLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0XHRcdC8vIFN1cHBvcnQgSUU2LThcclxuXHRcdFx0XHRcdHZhciBjbGlja2VkRWxlbWVudCA9IGV2ZW50LnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XHJcblxyXG5cdFx0XHRcdFx0Ly9Pbmx5IGxpc3RlbiB0byBjbGlja3Mgb24gbWVudS1sYWJlbCBlbGVtZW50cy5cclxuXHRcdFx0XHRcdGlmIChjbGlja2VkRWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZignbWVudS1sYWJlbCcpID4gLTEpIHtcclxuXHRcdFx0XHRcdFx0c2VsZi5fdG9nZ2xlQWN0aXZlKGNsaWNrZWRFbGVtZW50KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblx0XHRhY2NvcmRpb24uX3RvZ2dsZUFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHRcdFx0dmFyIGJvZHlFbCA9IGl0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG5cdFx0XHQvL0lmIGl0ZW0gdGl0bGUgaXMgbm90IGFjdGl2ZVxyXG5cdFx0XHRpZiAoaXRlbS5jbGFzc05hbWUuaW5kZXhPZignYWN0aXZlJykgPT09IC0xKSB7XHJcblx0XHRcdFx0Ly9BY3RpdmF0ZSBpdFxyXG5cdFx0XHRcdC8vaXRlbS5jbGFzc05hbWUgKz0gJyBhY3RpdmUgJztcclxuXHRcdFx0XHRpdGVtLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG5cclxuXHRcdFx0XHRib2R5RWwuc3R5bGUuaGVpZ2h0ID0gKHRoaXMuX2lubmVySGVpZ2h0KGJvZHlFbCkqMS4zKSsncHgnO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdC8vRGVzYWN0aXZhdGUgaXRcclxuXHRcdFx0XHQvL2l0ZW0uY2xhc3NOYW1lID0gaXRlbS5jbGFzc05hbWUucmVwbGFjZSgvIGFjdGl2ZSAvZywnJyk7XHRcclxuXHRcdFx0XHRpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG5cdFx0XHRcdGJvZHlFbC5zdHlsZS5oZWlnaHQgPSAwO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gaXRlbTtcclxuXHJcblx0XHR9O1xyXG5cclxuXHRcdGFjY29yZGlvbi5faW5uZXJIZWlnaHQgPSBmdW5jdGlvbihlbCkge1xyXG5cdFx0XHRoZWlnaHQgPSAwO1xyXG5cdFx0XHR2YXIgaW5uZXJFbGVtZW50cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJyonKTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaTwgaW5uZXJFbGVtZW50cy5sZW5ndGg7IGkrKyApIHtcclxuXHRcdFx0XHRoZWlnaHQgKz0gaW5uZXJFbGVtZW50c1tpXS5jbGllbnRIZWlnaHQ7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiBoZWlnaHQ7XHJcblx0XHR9O1xyXG5cclxuXHRcdHdpbmRvdy4kQUMgPSBhY2NvcmRpb247XHJcblxyXG59KSh3aW5kb3cpO1xyXG5cclxuJEFDLmluaXQoKTsiLCIoZnVuY3Rpb24od2luZG93KXtcclxuXHR2YXIgY2FsYyA9IHtcclxuXHRyZXN1bHQ6IG51bGwsXHJcblx0ZWxlbWVudHM6IHtcclxuXHRcdCdkaXNwbGF5JzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc3BsYXknKVxyXG5cdH0sXHJcblxyXG5cdF9zZXREaXNwbGF5OiBmdW5jdGlvbihjb250ZW50KSB7XHJcblx0XHRkaXNwbGF5LnZhbHVlID0gY29udGVudDtcclxuXHR9LFxyXG5cclxuXHRjbGVhcjogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLl9zZXREaXNwbGF5KCcnKTtcclxuXHR9LFxyXG5cclxuXHRkZWw6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGRpc3BsYXlWYWx1ZSA9ICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkudmFsdWUuc2xpY2UoMCwtMSk7XHJcblxyXG5cdFx0aWYoZGlzcGxheVZhbHVlW2Rpc3BsYXlWYWx1ZS5sZW5ndGgtMV0gPT09ICcuJyBcclxuXHRcdCAgIHx8IGRpc3BsYXlWYWx1ZVtkaXNwbGF5VmFsdWUubGVuZ3RoLTFdID09PSAnLCcgKVx0e1xyXG5cdFx0XHRkaXNwbGF5VmFsdWUgPSBkaXNwbGF5VmFsdWUuc2xpY2UoMCwtMSkvL1JlbW92ZSAsIG9yIC5cclxuXHRcdH1cclxuXHRcdHRoaXMuX3NldERpc3BsYXkoZGlzcGxheVZhbHVlKTtcclxuXHR9LFxyXG5cdGVxdWFsczogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLnJlc3VsdCA9IHRoaXMuZWxlbWVudHMuZGlzcGxheS52YWx1ZTtcclxuXHRcdHZhciBldmFsQ29kZSA9ICcnKyAodGhpcy5yZXN1bHQgLyAxMDApICsnOyc7XHJcblx0XHRcclxuXHRcdHRoaXMuX3NldERpc3BsYXkoZXZhbChldmFsQ29kZSkpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5jYWxjID0gY2FsYztcclxuXHJcbn0pKHdpbmRvdyk7IiwiLy8kY2Fyb3VzZWxcclxuKGZ1bmN0aW9uKHdpbmRvdyl7XHJcblxyXG5mdW5jdGlvbiBDYXJvdXNlbChlbGVtZW50KSB7XHJcblx0dmFyIHJvb3QgPSBlbGVtZW50O1xyXG5cdHRoaXMuaXRlbXMgPSByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJvdXNlbF9faXRlbXMgPiAuY2Fyb3VzZWxfX2l0ZW0nKTtcclxuXHR0aGlzLm5hdkl0ZW1zID0gbnVsbDtcclxuXHR0aGlzLmFycm93cyA9IG51bGw7XHJcblxyXG5cdHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5fZ2VuZXJhdGVOYXZpZ2F0aW9uKCk7XHJcblx0XHR0aGlzLl9nZW5lcmF0ZUFycm93cygpO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuZ29UbyA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcblx0XHR2YXIgc2VsZWN0ZWROYXYgPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5jYXJvdXNlbF9fbmF2ID4gLmNhcm91c2VsX19uYXYtaXRlbS0tYWN0aXZlJyk7XHJcblx0XHR2YXIgc2VsZWN0ZWRDb250ZW50ID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWxfX2l0ZW0tLWFjdGl2ZScpO1xyXG5cclxuXHRcdHNlbGVjdGVkTmF2LmNsYXNzTGlzdC5yZW1vdmUoJ2Nhcm91c2VsX19uYXYtaXRlbS0tYWN0aXZlJyk7XHJcblx0XHRzZWxlY3RlZENvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSgnY2Fyb3VzZWxfX2l0ZW0tLWFjdGl2ZScpO1xyXG5cclxuXHRcdHRoaXMubmF2SXRlbXNbaW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2Nhcm91c2VsX19uYXYtaXRlbS0tYWN0aXZlJyk7XHJcblx0XHR0aGlzLml0ZW1zW2luZGV4XS5jbGFzc0xpc3QuYWRkKCdjYXJvdXNlbF9faXRlbS0tYWN0aXZlJyk7XHJcblx0fVxyXG5cclxuXHR0aGlzLmFycm93TmF2ID0gZnVuY3Rpb24oZGlyZWN0aW9uKSB7XHJcblx0XHR2YXIgc2VsZWN0ZWROYXYgPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5jYXJvdXNlbF9fbmF2ID4gLmNhcm91c2VsX19uYXYtaXRlbS0tYWN0aXZlJyk7XHJcblx0XHR2YXIgZ290b0luZGV4ID0gTnVtYmVyLnBhcnNlSW50KHNlbGVjdGVkTmF2LmRhdGFzZXQuaW5kZXgpICsgZGlyZWN0aW9uO1x0XHRcclxuXHRcdHZhciBnb1RvID0gdGhpcy5uYXZJdGVtc1tnb3RvSW5kZXhdO1xyXG5cclxuXHRcdGlmKGdvVG8gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHQoZGlyZWN0aW9uID4gMCkgPyBnb3RvSW5kZXggPSAwIDogZ290b0luZGV4ID0gdGhpcy5uYXZJdGVtcy5sZW5ndGggLSAxO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZ29Ubyhnb3RvSW5kZXgpO1xyXG5cdH1cclxuXHJcblx0dGhpcy5fZ2VuZXJhdGVOYXZpZ2F0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHR2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xyXG5cdFx0dmFyIGh0bWwgPSAnJztcclxuXHRcdHZhciBmaXJzdENsYXNzID0gJ2Nhcm91c2VsX19uYXYtaXRlbS0tYWN0aXZlJztcclxuXHJcblx0XHR2YXIgbmF2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuXHRcdGh0bWwgKz0gJzx1bCBjbGFzcz1cImNhcm91c2VsX19uYXZcIj4nO1xyXG5cclxuXHRcdGZvcih2YXIgeCA9IDA7IHggPCBpdGVtcy5sZW5ndGg7IHgrKykge1xyXG5cdFx0XHRodG1sICs9ICc8bGkgY2xhc3M9XCJjYXJvdXNlbF9fbmF2LWl0ZW0gJysgZmlyc3RDbGFzcyArJ1wiIGRhdGEtaW5kZXg9Jyt4Kyc+IDwvbGk+JztcclxuXHRcdFx0Zmlyc3RDbGFzcyA9ICcnO1xyXG5cdFx0fVxyXG5cclxuXHRcdGh0bWwgKz0gJzwvdWw+JztcclxuXHJcblx0XHRuYXZFbGVtZW50LmlubmVySFRNTCA9IGh0bWw7XHJcblxyXG5cdFx0cm9vdC5hcHBlbmRDaGlsZChuYXZFbGVtZW50KTtcclxuXHRcdHRoaXMubmF2SXRlbXMgPSByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJvdXNlbF9fbmF2ID4gbGknKTtcclxuXHJcblx0XHRmb3IgKHZhciB4ID0gMDsgeCA8IHRoaXMubmF2SXRlbXMubGVuZ3RoOyB4KyspIHtcclxuXHRcdFx0dGhpcy5uYXZJdGVtc1t4XS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0c2VsZi5hcnJvd05hdigxKTtcclxuXHRcdFx0XHRzZWxmLmdvVG8odGhpcy5kYXRhc2V0LmluZGV4KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR0aGlzLl9nZW5lcmF0ZUFycm93cyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0dmFyIGFycm93Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRhcnJvd0NvbnRhaW5lci5pbm5lckhUTUwgPSBcclxuXHRcdCc8c3BhbiBjbGFzcz1cImNhcm91c2VsX19hcnJvdyBjYXJvdXNlbF9fYXJyb3ctLWxlZnQgZmEgZmEtY2hldnJvbi1sZWZ0XCI+PC9zcGFuPidcclxuXHQgIFx0Kyc8c3BhbiBjbGFzcz1cImNhcm91c2VsX19hcnJvdyBjYXJvdXNlbF9fYXJyb3ctLXJpZ2h0IGZhIGZhLWNoZXZyb24tcmlnaHRcIj48L3NwYW4+JztcclxuXHJcblx0ICBcdHJvb3QuYXBwZW5kQ2hpbGQoYXJyb3dDb250YWluZXIpO1xyXG5cclxuXHQgIFx0cm9vdC5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWxfX2Fycm93LS1sZWZ0JylcclxuXHQgIFx0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICBcdFx0XHRzZWxmLmFycm93TmF2KC0xKTtcclxuXHQgIFx0fSk7XHJcblxyXG5cdFx0cm9vdC5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWxfX2Fycm93LS1yaWdodCcpXHJcblx0ICBcdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgXHRcdFx0c2VsZi5hcnJvd05hdigxKTtcclxuXHQgIFx0fSk7XHQgIFx0XHJcblx0fVxyXG59XHJcblxyXG53aW5kb3cuY2Fyb3VzZWwgPSBmdW5jdGlvbihlbGVtZW50cykge1xyXG5cdHZhciBjYXJvdXNlbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2Fyb3VzZWwnKTtcclxuXHJcblxyXG5cdGZvciAodmFyIHggPSAwOyB4IDwgY2Fyb3VzZWxzLmxlbmd0aDsgeCsrKSB7XHJcblx0XHR2YXIgY2FyID0gbmV3IENhcm91c2VsKGNhcm91c2Vsc1t4XSk7XHJcblx0XHRjYXIuaW5pdCgpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIGNhcjtcclxufSgpO1xyXG59KSh3aW5kb3cpOyIsImZ1bmN0aW9uIHdpbmRvd1dpZHRoQ291bnQoKSB7XHJcblx0dmFyICR3aWR0aExhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndpbmRvdy13aWR0aC1sYWJlbCcpO1x0XHJcblx0JHdpZHRoTGFiZWwuaW5uZXJIVE1MID0gd2luZG93Lm91dGVyV2lkdGg7XHJcbn1cclxuXHJcbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHR3aW5kb3dXaWR0aENvdW50KCk7XHJcbn1cclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbigpe1xyXG5cdHdpbmRvd1dpZHRoQ291bnQoKTtcdFxyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNsb3NlTGF0ZXJhbE1lbnUoKSB7XHJcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lbnUtb3BlbicpLmNoZWNrZWQgPSAnJztcclxufVxyXG5cclxuZnVuY3Rpb24gbG9hZExpdmVFeGFtcGxlKHNyYykge1xyXG5cdHZhciAkaWZyYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmlmcmFtZS1saXZlJyk7XHJcblx0JGlmcmFtZS5zcmMgPSBzcmM7XHJcbn0iLCIoZnVuY3Rpb24od2luZG93KXtcclxuXHQvL0dldCBhbGwgaW1hZ2VzIHRvIGJlIGxhenkgbG9hZGVkXHJcblx0JGltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZ1tkYXRhLXNyY10nKTtcclxuXHJcblx0Ly9UbyBlYWNoIGltYWdlXHJcblx0Zm9yKHZhciB4PTA7IHg8JGltYWdlcy5sZW5ndGg7IHgrKykge1xyXG5cdFx0dmFyIGxvYWRpbmcgPSBjcmVhdGVMb2FkaW5nKCk7XHJcblxyXG5cdFx0Ly9JbnNlcnQgbG9hZGluZyBlbGVtZW50IGJlZm9yZSB0aGUgaW1hZ2VcclxuXHRcdCRpbWFnZXNbeF0ucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUobG9hZGluZywgJGltYWdlc1t4XSk7XHJcblxyXG5cdFx0Ly9EZWZpbmUgc3JjIGF0dHJpYnV0ZSB3aXRoIHRoZSBkYXRhLXNyY1xyXG5cdFx0JGltYWdlc1t4XS5zZXRBdHRyaWJ1dGUoJ3NyYycsICRpbWFnZXNbeF0uZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpKTtcclxuXHJcblx0XHQkaW1hZ2VzW3hdLm9ubG9hZCA9IG9uTG9hZEltYWdlKCRpbWFnZXNbeF0sbG9hZGluZyk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvbkxvYWRJbWFnZShpbWFnZSwgbG9hZGluZykge1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvL1JlbW92ZSBsb2FkaW5nIHdoZW4gaW1hZ2UgbG9hZHMuXHJcblx0XHRcdGxvYWRpbmcucmVtb3ZlKCk7XHJcblx0XHRcdC8vUmVtb3ZlIGRhdGEtc3JjIHRvIGFwcGx5IHRoZSBuZWVkZWQgY3NzIGFuaW1hdGlvbnMuIFxyXG5cdFx0XHRpbWFnZS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3JjJyk7XHRcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRmdW5jdGlvbiBjcmVhdGVMb2FkaW5nKCkge1xyXG5cdFx0dmFyIGxvYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdGxvYWRpbmcuY2xhc3NMaXN0LmFkZChcImltZy1sb2FkZXJcIik7XHJcblx0XHRsb2FkaW5nLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwiaW1nLWxvYWRlcl9faWNvblwiPidcclxuXHRcdCsgJzxzcGFuIGNsYXNzPVwiZmEgZmEtcmVmcmVzaCBmYS1zcGluXCI+PC9zcGFuPidcclxuXHRcdCsgJzwvZGl2Pic7XHJcblxyXG5cdFx0cmV0dXJuIGxvYWRpbmc7XHJcblx0fVxyXG5cclxuXHJcbn0pKHdpbmRvdyk7IiwiKGZ1bmN0aW9uKHdpbmRvdyl7XHJcbi8vQ2xhc3MgYXBwbGllZCB3aGVuIG1vZGFsIG9wYWNpdHkgaXMgMVxyXG52YXIgY2JDbGFzcyA9ICdtb2RhbF9fb3ZlcmxheS0tYWN0aXZlJztcclxuXHJcbmZ1bmN0aW9uIGZhZGVPdXQoZWwpe1xyXG4gIGVsLnN0eWxlLm9wYWNpdHkgPSAxO1xyXG5cclxuICAoZnVuY3Rpb24gZmFkZSgpIHtcclxuICAgIGlmICgoZWwuc3R5bGUub3BhY2l0eSAtPSAuMSkgPCAwKSB7XHJcbiAgICAgIC8vZWwucmVtb3ZlKCk7XHJcbiAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjYkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmYWRlKTtcclxuICAgIH1cclxuICB9KSgpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZmFkZUluKGVsKXtcclxuICBlbC5zdHlsZS5vcGFjaXR5ID0gMDtcclxuICBlbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cclxuICAoZnVuY3Rpb24gZmFkZSgpIHtcclxuICAgIHZhciB2YWwgPSBwYXJzZUZsb2F0KGVsLnN0eWxlLm9wYWNpdHkpO1xyXG4gICAgLy9JbmNyZWFzZSBvcGFjaXR5IHdoaWxlIGl0IGlzIG5vdCB0b3RhbGx5IG9wYXF1ZS5cclxuICAgIGlmICghKCh2YWwgKz0gLjEpID4gMSkpIHtcclxuICAgICAgZWwuc3R5bGUub3BhY2l0eSA9IHZhbDtcclxuICAgICAgZWwuY2xhc3NMaXN0LmFkZChjYkNsYXNzKTtcclxuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZhZGUpO1xyXG4gICAgfVxyXG4gIH0pKCk7XHJcbn1cclxuXHJcbndpbmRvdy5tb2RhbCA9IGZ1bmN0aW9uKGlkTW9kYWwpIHtcclxuICB2YXIgbW9kYWxPdmVybGF5ID0gbnVsbDtcclxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1tb2RhbC1pZD1cIicrIGlkTW9kYWwgKydcIl0nKTtcclxuXHJcbiAgZnVuY3Rpb24gX2NyZWF0ZU92ZXJsYXkoKSB7XHJcbiAgICB2YXIgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuXHJcbiAgICAvL0NyZWF0ZSBtb2RhbCBvdmVybGF5IGVsZW1lbnRcclxuICAgIG1vZGFsT3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlY3Rpb24nKTtcclxuICAgIG1vZGFsT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICBcclxuICAgIG1vZGFsT3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdtb2RhbF9fb3ZlcmxheScpO1xyXG4gICAgbW9kYWxPdmVybGF5LmNsYXNzTGlzdC5hZGQoJ21vZGFsX19vdmVybGF5LS1hY3RpdmUnKTtcclxuICAgIFxyXG4gICAgLy9NYWtlIG1vZGFsIGNvbnRhaW5lciB2aXNpYmxlXHJcbiAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cclxuICAgIC8vQXBwZW5kIG1vZGFsIGNvbnRhaW5lciBpbnRvIHRoZSBmcmVzaCBuZXcgb3ZlcmxheVxyXG4gICAgbW9kYWxPdmVybGF5LmFwcGVuZENoaWxkKG1vZGFsKTtcclxuICAgIFxyXG4gICAgLy9BcHBlbmQgbW9kYWwgb3ZlcmxheSBpbnRvIHRoZSBkb2N1bWVudC5cclxuICAgIGJvZHkuYXBwZW5kQ2hpbGQobW9kYWxPdmVybGF5KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIF9yZWdpc3RlckNsb3NlRXZlbnRzKCkge1xyXG4gICAgdmFyIGNsb3NlRWxlbWVudHMgPSBtb2RhbE92ZXJsYXkucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtY2xvc2VdJyk7XHJcblxyXG4gICAgZm9yKHZhciB4ID0gMDsgeCA8IGNsb3NlRWxlbWVudHMubGVuZ3RoOyB4KyspIHtcclxuICAgICAgY2xvc2VFbGVtZW50c1t4XS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgZmFkZU91dChtb2RhbE92ZXJsYXkpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbiAgLy9DaGVjayBpZiBtb2RhbCBpcyBhbHJlYWR5IGNyZWF0ZWQuXHJcbiAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5ID4gW2RhdGEtbW9kYWwtaWQ9XCInKyBpZE1vZGFsICsnXCJdJykpIHtcclxuICAgIC8vU2V0IG1vZGFsIG92ZXJsYXkgYXMgdGhlIGFscmVhZHkgY3JlYXRlZCBtb2RhbCBvdmVybGF5LiAgICBcclxuICAgIG1vZGFsT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheSA+IFtkYXRhLW1vZGFsLWlkPVwiJysgaWRNb2RhbCArJ1wiXScpLnBhcmVudEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBpZihtb2RhbE92ZXJsYXkgPT09IG51bGwpIHtcclxuICAgIF9jcmVhdGVPdmVybGF5KCk7XHJcbiAgICBfcmVnaXN0ZXJDbG9zZUV2ZW50cygpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGZhZGVJbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKG1vZGFsT3ZlcmxheSk7XHJcbiAgICAgIGZhZGVJbihtb2RhbE92ZXJsYXkpO1xyXG4gICAgfSxcclxuICAgIGZhZGVPdXQ6IGZ1bmN0aW9uKCl7XHJcbiAgICAgIGNvbnNvbGUubG9nKG1vZGFsT3ZlcmxheSk7XHJcbiAgICAgIGZhZGVPdXQobW9kYWxPdmVybGF5KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcblxyXG4vL0luaXQgbW9kYWwgb3BlbmVyc1xyXG52YXIgbW9kYWxPcGVuZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9kYWwtb3Blbl0nKTtcclxuXHJcbi8vQWRkIGZhZGVJbiBhY3Rpb24gb24gY2xpY2sgZXZlbnQgb2YgYWxsIG1vZGFsIG9wZW5lciBlbGVtZW50cy5cclxuZm9yKHZhciB4PTA7IHg8IG1vZGFsT3BlbmVycy5sZW5ndGg7IHgrKykge1xyXG4gIG1vZGFsT3BlbmVyc1t4XS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKXtcclxuICAgIHZhciBpZE1vZGFsID0gdGhpcy5kYXRhc2V0Lm1vZGFsT3BlbjtcclxuICAgIHdpbmRvdy5tb2RhbChpZE1vZGFsKS5mYWRlSW4oKTtcclxuICB9KTtcclxufVxyXG5cclxuXHJcbn0pKHdpbmRvdyk7XHJcblxyXG4iLCIvLyBSZWZlcmVuY2U6IGh0dHA6Ly93d3cucGF1bGlyaXNoLmNvbS8yMDExL3JlcXVlc3RhbmltYXRpb25mcmFtZS1mb3Itc21hcnQtYW5pbWF0aW5nL1xyXG53aW5kb3cucmVxdWVzdEFuaW1GcmFtZSA9IChmdW5jdGlvbigpIHtcclxuICByZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgLy9Xb3JzdCBjYXNlIHNjZW5hcmlvIHRyaWdnZXIgYW5pbWF0aW9uIHZpYSBzZXRUaW1lb3V0LlxyXG4gICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTtcclxuICAgIH07XHJcbn0pKCk7XHJcblxyXG4vL1RoaXMgaXMgYW4gYWRhcHRhdGlvbiBmcm9tIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE3NzIyNDk3L3Njcm9sbC1zbW9vdGhseS10by1zcGVjaWZpYy1lbGVtZW50LW9uLXBhZ2VcclxuKGZ1bmN0aW9uKHdpbmRvdyl7XHJcbiAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAvL1RPRE8gRmxleGJpbGl6ZSB0aGlzIGNvZGUuXHJcbiAgdmFyIHNjcm9sbFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50LWhvbGRlcicpO1xyXG4gIFxyXG4gIC8vVE9ETyBGbGV4aWJpbGl6ZSB0aGlzIGNvZGUuXHJcbiAgdmFyIG1lbnVIZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2YmFyJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgMTA7XHJcbiAgICBcclxuICBzZWxmLmdldFBvc1kgPSBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICBlbGVtZW50ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgIHJldHVybiBlbGVtZW50LnRvcCArIHNjcm9sbFdpbmRvdy5zY3JvbGxUb3AgLSAobWVudUhlaWdodCk7XHJcbiAgfTtcclxuXHJcbiAgc2VsZi5zY3JvbGxUb0VsZW1lbnQgPSBmdW5jdGlvbihlbGVtZW50LCBkdXJhdGlvbiwgY2JGdW5jdGlvbikgeyBcclxuICAgIGlmKCAhZHVyYXRpb24gKSB7XHJcbiAgICAgIGR1cmF0aW9uID0gMTAwMDtcclxuICAgIH1cclxuXHJcbiAgICAvL0lmIENTUyBzZWxlY3RvciBpcyBwYXNzZWQuXHJcbiAgICBpZiggIWVsZW1lbnQubm9kZU5hbWUgKSB7XHJcbiAgICAgIC8vIFF1ZXJ5IGl0IGludG8gRE9NIGVsZW1lbnRcclxuICAgICAgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoICFlbGVtZW50ICkge1xyXG4gICAgICB0aHJvdyBcIkVsZW1lbnQgaW5leGlzdGVudCFcIjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgc3RhcnRpbmdZID0gc2Nyb2xsV2luZG93LnNjcm9sbFRvcDtcclxuXHJcbiAgICB2YXIgZGlmZiA9IHNlbGYuZ2V0UG9zWShlbGVtZW50KSAtIHN0YXJ0aW5nWTtcclxuICAgIHZhciBzdGFydDtcclxuXHJcbiAgICAvL0dvdCBmcm9tIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2dyZS8xNjUwMjk0XHJcbiAgICB2YXIgZWFzaW5nID0gZnVuY3Rpb24gKHQpIHsgXHJcbiAgICAgIHJldHVybiB0IDwgLjUgPyA0KnQqdCp0IDogKHQtMSkqKDIqdC0yKSooMip0LTIpKzE7IFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEJvb3RzdHJhcCBvdXIgYW5pbWF0aW9uIC0gaXQgd2lsbCBnZXQgY2FsbGVkIHJpZ2h0IGJlZm9yZSBuZXh0IGZyYW1lIHNoYWxsIGJlIHJlbmRlcmVkLlxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltRnJhbWUoZnVuY3Rpb24gc3RlcCh0aW1lc3RhbXApIHtcclxuICAgICAgaWYgKCFzdGFydCkgc3RhcnQgPSB0aW1lc3RhbXA7XHJcbiAgICAgIFxyXG4gICAgICAvLyBFbGFwc2VkIG1pbGlzZWNvbmRzIHNpbmNlIHN0YXJ0IG9mIHNjcm9sbGluZy5cclxuICAgICAgdmFyIHRpbWUgPSB0aW1lc3RhbXAgLSBzdGFydDtcclxuICAgICAgLy8gR2V0IHBlcmNlbnQgb2YgY29tcGxldGlvbiBpbiByYW5nZSBbMCwgMV0uXHJcbiAgICAgIHZhciBwZXJjZW50ID0gTWF0aC5taW4odGltZSAvIGR1cmF0aW9uLCAxKTtcclxuXHJcbiAgICAgIHBlcmNlbnQgPSBlYXNpbmcocGVyY2VudCk7XHJcbiAgICAgIFxyXG4gICAgICBzY3JvbGxXaW5kb3cuc2Nyb2xsVG8oMCwgc3RhcnRpbmdZICsgZGlmZiAqIHBlcmNlbnQpO1xyXG5cclxuICAgICAgLy8gUHJvY2VlZCB3aXRoIGFuaW1hdGlvbiBhcyBsb25nIGFzIHdlIHdhbnRlZCBpdCB0by5cclxuICAgICAgaWYgKHRpbWUgPCBkdXJhdGlvbikge1xyXG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbUZyYW1lKHN0ZXApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYoY2JGdW5jdGlvbikge1xyXG4gICAgICAgIC8vT24gYW5pbWF0aW9uIGVuZCBleGVjdXRlIGNhbGxiYWNrIGZ1bmN0aW9uIGlmIHByb3ZpZGVkLlxyXG4gICAgICAgIGNiRnVuY3Rpb24oKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH07XHJcblxyXG4gIHdpbmRvdy5zY3JvbGxUb0VsZW1lbnQgPSBzZWxmLnNjcm9sbFRvRWxlbWVudDtcclxuICBcclxuXHJcbn0pKHdpbmRvdyk7XHJcblxyXG5cclxuIiwiXHJcbihmdW5jdGlvbih3aW5kb3cpe1xyXG5cclxuXHR2YXIgdGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWJfX3RpdGxlJyk7XHJcblxyXG5cdGZ1bmN0aW9uIHRvZ2dsZVRhYih0YWJJZCkge1xyXG5cdFx0dmFyIHByZXZpb3VzVGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWJfX3RpdGxlLS1zZWxlY3RlZCcpO1xyXG5cdFx0dmFyIHByZXZpb3VzQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWJfX2NvbnRlbnQtLXNlbGVjdGVkJyk7XHJcblx0XHR2YXIgYWN0aXZlQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1jb250ZW50LWlkPSdcIit0YWJJZCtcIiddXCIpO1xyXG5cdFx0dmFyIGFjdGl2ZVRhYnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtdGFiLWlkPSdcIit0YWJJZCtcIiddXCIpO1xyXG5cdFx0XHJcblx0XHQvL0RlYWN0aXZhdGUgcHJldmlvdXMgc2VsZWN0ZWQgdGFic1xyXG5cdFx0Zm9yKHZhciBpPTA7IGkgPCBwcmV2aW91c1RhYnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0cHJldmlvdXNUYWJzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ3RhYl9fdGl0bGUtLXNlbGVjdGVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9BY3RpdmF0ZSB0aGUgY3VycmVudCBjb250ZW50XHJcblx0XHRmb3IodmFyIGk9MDsgaSA8IGFjdGl2ZVRhYnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0YWN0aXZlVGFic1tpXS5jbGFzc0xpc3QuYWRkKCd0YWJfX3RpdGxlLS1zZWxlY3RlZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vVG9nZ2xlIGJldHdlZW4gcHJldmlvdXMgY29udGVudCBhbmQgXHJcblx0XHRwcmV2aW91c0NvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSgndGFiX19jb250ZW50LS1zZWxlY3RlZCcpO1xyXG5cdFx0YWN0aXZlQ29udGVudC5jbGFzc0xpc3QuYWRkKCd0YWJfX2NvbnRlbnQtLXNlbGVjdGVkJyk7XHJcblx0fVxyXG5cclxuXHRmb3IodmFyIGkgPTAgOyBpIDwgdGFicy5sZW5ndGg7IGkrKykge1xyXG5cclxuXHRcdHRhYnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7XHJcblx0XHRcdHRvZ2dsZVRhYih0aGlzLmRhdGFzZXQudGFiSWQpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHR2YXIgdGFic0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWJfX2NvbnRhaW5lciA+IC50YWJfX3RpdGxlJyk7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0YWJzQ29udGFpbmVyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHQvL09uIG1vYmlsZSBkZXZpY2VzLCBwb3NpdGlvbiB0aGUgd2luZG93IGluIGZyb250IG9mIHRoZSBhY3RpdmUgdGFiLlxyXG5cdFx0dGFic0NvbnRhaW5lcltpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKXtcclxuXHRcdFx0d2luZG93LnNjcm9sbFRvRWxlbWVudCh0aGlzLDEwMDApO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxufSkod2luZG93KTtcclxuIl19
